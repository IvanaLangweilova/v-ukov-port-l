<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>V√Ωukov√Ω port√°l Z≈† ‚Äì procviƒçov√°n√≠</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;

            /* stejn√© pastelov√© ‚Äûk≈ô√≠dov√©‚Äú pozad√≠ jako na √∫vodn√≠ str√°nce */
            background:
                radial-gradient(circle at 15% 20%, rgba(255, 234, 167, 0.55), transparent 60%),
                radial-gradient(circle at 85% 30%, rgba(250, 177, 160, 0.55), transparent 60%),
                radial-gradient(circle at 30% 85%, rgba(129, 236, 236, 0.55), transparent 60%),
                radial-gradient(circle at 80% 80%, rgba(116, 185, 255, 0.55), transparent 60%),
                #ffffff;
            background-attachment: fixed;
            background-size: cover;

            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: rgba(45, 52, 54, 0.9);
            color: #ffffff;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        header h1 {
            margin: 0.2rem 0;
            font-size: 1.6rem;
        }

        header p {
            margin: 0;
            font-size: 0.95rem;
            opacity: 0.9;
        }

        main {
            flex: 1;
            display: flex;
            justify-content: center;
            padding: 1.5rem 0.5rem 2rem;
        }

        .app-card {
            width: 100%;
            max-width: 1000px;
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.20);
            padding: 1.5rem;
            animation: cardIn 0.5s ease-out;
        }

        @keyframes cardIn {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        section {
            display: none;
        }

        section.active {
            display: block;
        }

        /* √öVODN√ç OBRAZOVKA UVNIT≈ò APLIKACE */
        .intro {
            text-align: center;
            padding: 1rem;
        }

        .intro-title {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
        }

        .intro-subtitle {
            font-size: 1rem;
            color: #636e72;
            margin-bottom: 1.5rem;
        }

        .intro-graphic {
            margin: 1rem auto 1.5rem;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 20%, #ffeaa7, #fab1a0, #6c5ce7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            font-size: 2.2rem;
            font-weight: 700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            animation: float 2.5s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        .intro-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
        }

        button {
            padding: 0.55rem 0.9rem;
            font-size: 0.95rem;
            cursor: pointer;
            border-radius: 999px;
            border: none;
            font-weight: 600;
            letter-spacing: 0.02em;
            transition: transform 0.12s ease, box-shadow 0.12s ease, background-color 0.12s ease, opacity 0.12s ease;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
        }

        button:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-primary {
            background: #0984e3;
            color: #ffffff;
        }

        .btn-primary:hover:not(:disabled) {
            background: #0769b6;
        }

        .btn-outline {
            background: #ffffff;
            color: #2d3436;
            border: 1px solid #b2bec3;
        }

        .btn-outline:hover:not(:disabled) {
            background: #ecf0f1;
        }

        /* V√ùBƒöR P≈òEDMƒöT≈Æ */
        .subjects-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .subjects-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .subjects-subtitle {
            font-size: 0.9rem;
            color: #636e72;
        }

        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.75rem;
        }

        .subject-card {
            background: #f9fafb;
            border-radius: 12px;
            padding: 0.7rem;
            text-align: center;
            border: 1px solid #dfe6e9;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            transition: transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s;
        }

        .subject-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-color: #0984e3;
        }

        .subject-icon {
            width: 40px;
            height: 40px;
            border-radius: 999px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #ffffff;
            font-size: 1.1rem;
        }

        .subject-name {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .subject-note {
            font-size: 0.75rem;
            color: #636e72;
        }

        .subject-disabled {
            opacity: 0.6;
            cursor: default;
        }

        .subject-disabled:hover {
            transform: none;
            box-shadow: none;
            border-color: #dfe6e9;
        }

        /* OVL√ÅDAC√ç PANEL A KV√çZ */
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.2rem;
            align-items: flex-end;
        }

        .controls-group {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            min-width: 130px;
        }

        .controls label {
            font-weight: 600;
            font-size: 0.9rem;
            color: #2d3436;
        }

        select {
            padding: 0.45rem 0.6rem;
            font-size: 0.95rem;
            border-radius: 10px;
            border: 1px solid #dfe6e9;
            background-color: #f5f6fa;
            outline: none;
            transition: border-color 0.15s, box-shadow 0.15s, background-color 0.15s;
        }

        select:focus {
            border-color: #0984e3;
            box-shadow: 0 0 0 2px rgba(9,132,227,0.20);
            background-color: #ffffff;
        }

        .mode-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .mode-button {
            background: #dfe6e9;
            color: #2d3436;
        }

        .mode-button.active {
            background: #00b894;
            color: white;
            box-shadow: 0 4px 10px rgba(0,184,148,0.5);
        }

        #quiz-area {
            margin-top: 1rem;
            border-top: 1px solid #dfe6e9;
            padding-top: 1rem;
        }

        #status-bar {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 0.5rem;
            margin-bottom: 0.7rem;
            font-size: 0.9rem;
            color: #2d3436;
        }

        #timer {
            font-weight: 600;
            color: #d63031;
        }

        #score {
            font-weight: 600;
        }

        #question-container {
            background: #f9fafb;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            animation: fadeInQuestion 0.35s ease-out;
        }

        @keyframes fadeInQuestion {
            from {
                opacity: 0;
                transform: translateY(6px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #question-text {
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }

        .topic-pill {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 999px;
            font-size: 0.8rem;
            background: #ffeaa7;
            color: #636e72;
            margin-bottom: 0.4rem;
        }

        .options {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            gap: 0.45rem;
        }

        .options li {
            width: 100%;
        }

        .option-button {
            width: 100%;
            text-align: left;
            padding: 0.55rem 0.7rem;
            background: #ffffff;
            border-radius: 10px;
            border: 1px solid #dfe6e9;
            font-size: 0.95rem;
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .option-label {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.5rem;
            height: 1.5rem;
            border-radius: 999px;
            background: #dfe6e9;
            font-weight: 600;
            font-size: 0.8rem;
        }

        .option-text {
            flex: 1;
        }

        .option-button.correct {
            background: #00b894;
            color: white;
            border-color: #00b894;
        }

        .option-button.wrong {
            background: #d63031;
            color: white;
            border-color: #c0392b;
        }

        #feedback {
            margin-top: 0.5rem;
            font-weight: 600;
        }

        #feedback.ok {
            color: #00b894;
        }

        #feedback.bad {
            color: #d63031;
        }

        .bottom-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        #next-btn {
            background: #fdcb6e;
            color: #2d3436;
        }

        #next-btn:hover:not(:disabled) {
            background: #f5b942;
        }

        #finish-btn {
            background: #6c5ce7;
            color: white;
        }

        #finish-btn:hover:not(:disabled) {
            background: #574bdb;
        }

        #summary {
            margin-top: 1rem;
            padding: 0.8rem;
            background: #f1f2f6;
            border-radius: 12px;
            max-height: 260px;
            overflow: auto;
        }

        #summary h3 {
            margin-top: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }

        th, td {
            border: 1px solid #dcdde1;
            padding: 0.35rem;
        }

        th {
            background: #dfe6e9;
            position: sticky;
            top: 0;
        }

        @media (max-width: 700px) {
            .app-card {
                padding: 1rem;
                border-radius: 0.75rem;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            header h1 {
                font-size: 1.3rem;
            }
        }
    </style>
</head>
<body>
<header>
    <h1>V√Ωukov√Ω port√°l Z≈†</h1>
    <p>Procviƒçov√°n√≠ a testy ‚Äì matematika a dal≈°√≠ p≈ôedmƒõty</p>
</header>

<main>
    <div class="app-card">
        <!-- √öVODN√ç OBRAZOVKA -->
        <section id="screen-intro" class="intro active">
            <div class="intro-title">V√≠tej v procviƒçov√°n√≠ pro z√°kladn√≠ ≈°kolu</div>
            <div class="intro-subtitle">Vyber stupe≈à ≈°koly a potom p≈ôedmƒõt, kter√Ω chce≈° procviƒçovat.</div>

            <div class="intro-graphic">
                Z≈†
            </div>

            <div class="intro-buttons">
                <button class="btn-outline" type="button" disabled>
                    1. stupe≈à Z≈†<br>
                    <span style="font-size:0.75rem; font-weight:400;">zat√≠m nen√≠ implementov√°no</span>
                </button>
                <button id="btn-2nd" class="btn-primary" type="button">
                    2. stupe≈à Z≈†<br>
                    <span style="font-size:0.8rem; font-weight:400;">pokraƒçovat</span>
                </button>
            </div>
        </section>

        <!-- V√ùBƒöR P≈òEDMƒöTU -->
        <section id="screen-subjects">
            <div class="subjects-header">
                <div>
                    <div class="subjects-title">Vyber p≈ôedmƒõt ‚Äì 2. stupe≈à Z≈†</div>
                    <div class="subjects-subtitle">Zat√≠m je plnƒõ funkƒçn√≠ matematika (7. roƒçn√≠k), ostatn√≠ p≈ôedmƒõty jsou p≈ôipraven√© k roz≈°√≠≈ôen√≠.</div>
                </div>
                <button id="btn-back-intro" class="btn-outline" type="button">Zpƒõt na v√Ωbƒõr stupnƒõ</button>
            </div>

            <div class="subjects-grid">
                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#ff7675;">ƒåJ</div>
                    <div class="subject-name">ƒåesk√Ω jazyk</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card" data-subject="matematika">
                    <div class="subject-icon" style="background:#00b894;">M</div>
                    <div class="subject-name">Matematika</div>
                    <div class="subject-note">plnƒõ funkƒçn√≠</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#0984e3;">F</div>
                    <div class="subject-name">Fyzika</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#6c5ce7;">CH</div>
                    <div class="subject-name">Chemie</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#00cec9;">P≈ò</div>
                    <div class="subject-name">P≈ô√≠rodopis</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#e17055;">D</div>
                    <div class="subject-name">Dƒõjepis</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#0984e3;">AJ</div>
                    <div class="subject-name">Anglick√Ω jazyk</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>

                <div class="subject-card subject-disabled">
                    <div class="subject-icon" style="background:#2d3436;">NJ</div>
                    <div class="subject-name">Nƒõmeck√Ω jazyk</div>
                    <div class="subject-note">p≈ôipravuje se</div>
                </div>
            </div>
        </section>

        <!-- OBRAZOVKA S KV√çZEM (MATEMATIKA) -->
        <section id="screen-quiz">
            <div class="subjects-header">
                <div>
                    <div class="subjects-title" id="quiz-title">Matematika ‚Äì procviƒçov√°n√≠</div>
                    <div class="subjects-subtitle">Vyber roƒçn√≠k, t√©ma a re≈æim (procviƒçov√°n√≠ nebo ostr√Ω test).</div>
                </div>
                <button id="btn-back-subjects" class="btn-outline" type="button">Zmƒõnit p≈ôedmƒõt</button>
            </div>

            <section class="controls">
                <div class="controls-group">
                    <label for="grade">Roƒçn√≠k</label>
                    <select id="grade">
                        <option value="7. roƒçn√≠k">7. roƒçn√≠k</option>
                    </select>
                </div>

                <div class="controls-group">
                    <label for="topic">T√©ma (RVP)</label>
                    <select id="topic">
                        <option value="Zlomky a racion√°ln√≠ ƒç√≠sla">Zlomky a racion√°ln√≠ ƒç√≠sla</option>
                        <option value="Desetinn√° ƒç√≠sla">Desetinn√° ƒç√≠sla</option>
                        <option value="Jednoduch√© rovnice">Jednoduch√© rovnice</option>
                        <option value="√öhly">√öhly</option>
                        <option value="Troj√∫heln√≠k">Troj√∫heln√≠k</option>
                        <option value="Mnoho√∫heln√≠ky a osov√° soumƒõrnost">Mnoho√∫heln√≠ky a osov√° soumƒõrnost</option>
                        <option value="Objem a povrch kv√°dru a krychle">Objem a povrch kv√°dru a krychle</option>
                        <option value="P≈ôevody jednotek">P≈ôevody jednotek</option>
                        <option value="Slovn√≠ √∫lohy">Slovn√≠ √∫lohy</option>
                    </select>
                </div>

                <div class="controls-group">
                    <label>Re≈æim</label>
                    <div class="mode-buttons">
                        <button id="mode-practice" class="mode-button active" type="button">Procviƒçov√°n√≠</button>
                        <button id="mode-test" class="mode-button" type="button">Ostr√Ω test</button>
                    </div>
                </div>

                <div class="controls-group">
                    <label>&nbsp;</label>
                    <button id="start-btn" class="btn-primary" type="button">Spustit</button>
                </div>
            </section>

            <section id="quiz-area" style="display:none;">
                <div id="status-bar">
                    <div id="timer"></div>
                    <div id="score"></div>
                </div>

                <div id="question-container">
                    <span class="topic-pill" id="topic-pill"></span>
                    <div id="question-text"></div>
                    <ul id="options-list" class="options"></ul>
                </div>

                <div id="feedback"></div>

                <div class="bottom-buttons">
                    <button id="next-btn" type="button" style="display:none;">Dal≈°√≠ ot√°zka</button>
                    <button id="finish-btn" type="button" style="display:none;">Ukonƒçit test</button>
                </div>

                <div id="summary"></div>
            </section>
        </section>
    </div>
</main>

<script>
    // ---------- OT√ÅZKY ‚Äì MATEMATIKA, 7. ROƒåN√çK ----------
    const QUESTIONS = {
        "7. roƒçn√≠k": {
            "Zlomky a racion√°ln√≠ ƒç√≠sla": [
                {
                    text: "Zkra≈• zlomek 8/12.",
                    options: ["2/3", "3/4", "4/6", "1/2"],
                    correctIndex: 0
                },
                {
                    text: "Seƒçti: 1/3 + 1/6 =",
                    options: ["1/9", "1/2", "2/6", "3/6"],
                    correctIndex: 1
                },
                {
                    text: "P≈ôeveƒè: 0,75 na zlomek v z√°kladn√≠m tvaru.",
                    options: ["1/4", "3/4", "2/3", "4/5"],
                    correctIndex: 1
                },
                {
                    text: "Vydƒõl: 3/4 : 1/2 =",
                    options: ["3/8", "3/2", "1/2", "6/4"],
                    correctIndex: 1
                }
            ],

            "Desetinn√° ƒç√≠sla": [
                {
                    text: "Vypoƒç√≠tej: 3,5 + 1,27 =",
                    options: ["4,77", "4,57", "5,77", "3,62"],
                    correctIndex: 0
                },
                {
                    text: "Vypoƒç√≠tej: 6,4 - 2,75 =",
                    options: ["3,65", "3,55", "4,35", "3,75"],
                    correctIndex: 0
                },
                {
                    text: "P≈ôeveƒè: 2,03 m na cm.",
                    options: ["203 cm", "20,3 cm", "2 030 cm", "2030 m"],
                    correctIndex: 0
                }
            ],

            "Jednoduch√© rovnice": [
                {
                    text: "Vy≈ôe≈° rovnici: x + 7 = 15",
                    options: ["x = 7", "x = 8", "x = 22", "x = -8"],
                    correctIndex: 1
                },
                {
                    text: "Vy≈ôe≈° rovnici: 3x = 21",
                    options: ["x = 7", "x = 18", "x = 63", "x = 9"],
                    correctIndex: 0
                },
                {
                    text: "Vy≈ôe≈° rovnici: 20 - x = 6",
                    options: ["x = 26", "x = 14", "x = -14", "x = 3"],
                    correctIndex: 1
                }
            ],

            "√öhly": [
                {
                    text: "Dopl≈à do p≈ô√≠m√©ho √∫hlu: 180¬∞ ‚àí 65¬∞ =",
                    options: ["105¬∞", "115¬∞", "125¬∞", "135¬∞"],
                    correctIndex: 0
                },
                {
                    text: "Polovina √∫hlu 60¬∞ je:",
                    options: ["20¬∞", "30¬∞", "40¬∞", "15¬∞"],
                    correctIndex: 1
                },
                {
                    text: "T≈ôetina √∫hlu 90¬∞ je:",
                    options: ["10¬∞", "20¬∞", "30¬∞", "45¬∞"],
                    correctIndex: 2
                }
            ],

            "Troj√∫heln√≠k": [
                {
                    text: "Souƒçet vnit≈ôn√≠ch √∫hl≈Ø v troj√∫heln√≠ku je:",
                    options: ["90¬∞", "180¬∞", "270¬∞", "360¬∞"],
                    correctIndex: 1
                },
                {
                    text: "Troj√∫heln√≠k se stranami 5 cm, 5 cm, 8 cm je:",
                    options: ["rovnostrann√Ω", "rovnoramenn√Ω", "r≈Øznostrann√Ω", "pravo√∫hl√Ω"],
                    correctIndex: 1
                },
                {
                    text: "Kter√Ω troj√∫heln√≠k m√° v≈°echny strany stejnƒõ dlouh√©?",
                    options: ["rovnostrann√Ω", "rovnoramenn√Ω", "r≈Øznostrann√Ω", "rovno√∫hl√Ω"],
                    correctIndex: 0
                }
            ],

            "Mnoho√∫heln√≠ky a osov√° soumƒõrnost": [
                {
                    text: "Kolik stran m√° pravideln√Ω ≈°esti√∫heln√≠k?",
                    options: ["4", "5", "6", "8"],
                    correctIndex: 2
                },
                {
                    text: "Kter√© z p√≠smen je osovƒõ soumƒõrn√©?",
                    options: ["Z", "A", "F", "L"],
                    correctIndex: 1
                },
                {
                    text: "Kolik os soumƒõrnosti m√° ƒçtverec?",
                    options: ["1", "2", "4", "8"],
                    correctIndex: 2
                }
            ],

            "Objem a povrch kv√°dru a krychle": [
                {
                    text: "Kv√°dr m√° rozmƒõry 2 cm, 3 cm a 4 cm. Jeho objem je:",
                    options: ["9 cm¬≥", "20 cm¬≥", "24 cm¬≥", "18 cm¬≥"],
                    correctIndex: 2
                },
                {
                    text: "Krychle m√° hranu 5 cm. Jej√≠ objem je:",
                    options: ["25 cm¬≥", "125 cm¬≥", "15 cm¬≥", "5 cm¬≤"],
                    correctIndex: 1
                },
                {
                    text: "Krychle m√° hranu 3 cm. Jak√Ω je jej√≠ povrch?",
                    options: ["9 cm¬≤", "18 cm¬≤", "27 cm¬≤", "54 cm¬≤"],
                    correctIndex: 3
                }
            ],

            "P≈ôevody jednotek": [
                {
                    text: "P≈ôeveƒè: 3 m = ? cm",
                    options: ["30 cm", "300 cm", "3000 cm", "3 cm"],
                    correctIndex: 1
                },
                {
                    text: "P≈ôeveƒè: 0,5 kg = ? g",
                    options: ["5 g", "50 g", "500 g", "5000 g"],
                    correctIndex: 2
                },
                {
                    text: "P≈ôeveƒè: 2 000 ml = ? l",
                    options: ["0,2 l", "2 l", "20 l", "200 l"],
                    correctIndex: 1
                }
            ],

            "Slovn√≠ √∫lohy": [
                {
                    text: "V obchodƒõ zlevnili triƒçko z 400 Kƒç na 320 Kƒç. O kolik procent bylo triƒçko zlevnƒõno?",
                    options: ["10 %", "15 %", "20 %", "25 %"],
                    correctIndex: 2
                },
                {
                    text: "V krabici je 24 jablek. T≈ôi ƒçtvrtiny jablek jsou ƒçerven√°, zbytek zelen√°. Kolik je zelen√Ωch jablek?",
                    options: ["6", "8", "12", "18"],
                    correctIndex: 0
                },
                {
                    text: "Autobus jede pr≈Ømƒõrnou rychlost√≠ 60 km/h. Jak dlouho mu potrv√° ujet 150 km?",
                    options: ["1 hod 30 min", "2 hod 30 min", "2 hod 15 min", "3 hod"],
                    correctIndex: 1
                },
                {
                    text: "Obd√©ln√≠k m√° d√©lku 8 cm a ≈°√≠≈ôku 5 cm. Jak√Ω je jeho obsah?",
                    options: ["13 cm¬≤", "16 cm¬≤", "30 cm¬≤", "40 cm¬≤"],
                    correctIndex: 4
                },
                {
                    text: "T≈ô√≠da nasb√≠rala 120 kg pap√≠ru. Na jednoho ≈æ√°ka p≈ôipad√° pr≈Ømƒõrnƒõ 4 kg. Kolik ≈æ√°k≈Ø je ve t≈ô√≠dƒõ?",
                    options: ["20", "25", "30", "40"],
                    correctIndex: 2
                }
            ]
        }
    };

    // ---------- STAV ----------
    let currentSubject = null;
    let mode = "practice";
    let currentGrade = "7. roƒçn√≠k";
    let currentTopic = "Zlomky a racion√°ln√≠ ƒç√≠sla";

    let currentQuestions = [];
    let currentIndex = 0;
    let userAnswers = [];
    let correctCount = 0;

    let timerId = null;
    let timeLeft = 0;
    const TEST_QUESTION_COUNT = 10;
    const TEST_TIME_LIMIT = 5 * 60; // 5 minut

    // ---------- DOM ELEMENTY ----------
    const screenIntro = document.getElementById("screen-intro");
    const screenSubjects = document.getElementById("screen-subjects");
    const screenQuiz = document.getElementById("screen-quiz");

    const btn2nd = document.getElementById("btn-2nd");
    const btnBackIntro = document.getElementById("btn-back-intro");
    const btnBackSubjects = document.getElementById("btn-back-subjects");

    const quizTitle = document.getElementById("quiz-title");

    const gradeSelect = document.getElementById("grade");
    const topicSelect = document.getElementById("topic");
    const modePracticeBtn = document.getElementById("mode-practice");
    const modeTestBtn = document.getElementById("mode-test");
    const startBtn = document.getElementById("start-btn");

    const quizArea = document.getElementById("quiz-area");
    const questionText = document.getElementById("question-text");
    const topicPill = document.getElementById("topic-pill");
    const optionsList = document.getElementById("options-list");
    const feedback = document.getElementById("feedback");
    const timerDiv = document.getElementById("timer");
    const scoreDiv = document.getElementById("score");
    const nextBtn = document.getElementById("next-btn");
    const finishBtn = document.getElementById("finish-btn");
    const summaryDiv = document.getElementById("summary");

    // ---------- OBRAZOVKY ----------
    function showScreen(screen) {
        screenIntro.classList.remove("active");
        screenSubjects.classList.remove("active");
        screenQuiz.classList.remove("active");

        if (screen === "intro") screenIntro.classList.add("active");
        if (screen === "subjects") screenSubjects.classList.add("active");
        if (screen === "quiz") screenQuiz.classList.add("active");
    }

    btn2nd.addEventListener("click", () => {
        showScreen("subjects");
    });

    btnBackIntro.addEventListener("click", () => {
        showScreen("intro");
    });

    btnBackSubjects.addEventListener("click", () => {
        resetState();
        quizArea.style.display = "none";
        showScreen("subjects");
    });

    document.querySelectorAll(".subject-card[data-subject='matematika']").forEach(card => {
        card.addEventListener("click", () => {
            currentSubject = "matematika";
            quizTitle.textContent = "Matematika ‚Äì procviƒçov√°n√≠";
            showScreen("quiz");
        });
    });

    // ---------- RE≈ΩIMY ----------
    modePracticeBtn.addEventListener("click", () => {
        mode = "practice";
        modePracticeBtn.classList.add("active");
        modeTestBtn.classList.remove("active");
    });

    modeTestBtn.addEventListener("click", () => {
        mode = "test";
        modeTestBtn.classList.add("active");
        modePracticeBtn.classList.remove("active");
    });

    // ---------- START ----------
    startBtn.addEventListener("click", () => {
        currentGrade = gradeSelect.value;
        currentTopic = topicSelect.value;

        if (!QUESTIONS[currentGrade] || !QUESTIONS[currentGrade][currentTopic]) {
            alert("Pro zvolen√Ω roƒçn√≠k a t√©ma zat√≠m nejsou p≈ôipraven√© ot√°zky.");
            return;
        }

        startQuiz();
    });

    function startQuiz() {
        resetState();

        const allQuestions = QUESTIONS[currentGrade][currentTopic];
        const preparedQuestions = prepareQuestions(allQuestions);

        if (mode === "test") {
            currentQuestions = preparedQuestions.slice(0, Math.min(TEST_QUESTION_COUNT, preparedQuestions.length));
            timeLeft = TEST_TIME_LIMIT;
            startTimer();
            finishBtn.style.display = "inline-block";
            nextBtn.style.display = "none";
        } else {
            currentQuestions = preparedQuestions;
            finishBtn.style.display = "none";
            nextBtn.style.display = "inline-block";
            timerDiv.textContent = "";
        }

        quizArea.style.display = "block";
        showQuestion();
    }

    function resetState() {
        currentIndex = 0;
        userAnswers = [];
        correctCount = 0;
        feedback.textContent = "";
        feedback.className = "";
        summaryDiv.innerHTML = "";
        scoreDiv.textContent = "";
        stopTimer();
    }

    // ---------- OT√ÅZKA ----------
    function showQuestion() {
        if (currentIndex >= currentQuestions.length) {
            if (mode === "practice") {
                currentIndex = 0;
            } else {
                finishTest();
                return;
            }
        }

        const q = currentQuestions[currentIndex];
        topicPill.textContent = currentTopic;
        questionText.textContent = `Ot√°zka ${currentIndex + 1}: ${q.text}`;
        optionsList.innerHTML = "";
        feedback.textContent = "";
        feedback.className = "";

        const labels = ["A", "B", "C", "D", "E", "F"];

        q.options.forEach((opt, index) => {
            const li = document.createElement("li");
            const btn = document.createElement("button");
            btn.type = "button";
            btn.className = "option-button";

            const lab = document.createElement("span");
            lab.className = "option-label";
            lab.textContent = labels[index] || "?";

            const spanText = document.createElement("span");
            spanText.className = "option-text";
            spanText.textContent = opt;

            btn.appendChild(lab);
            btn.appendChild(spanText);

            btn.addEventListener("click", () => handleAnswer(index));

            li.appendChild(btn);
            optionsList.appendChild(li);
        });

        if (mode === "practice") {
            nextBtn.disabled = true;
        }
    }

    // ---------- ODPOVƒöƒé ----------
    function handleAnswer(selectedIndex) {
        const q = currentQuestions[currentIndex];

        if (mode === "practice") {
            const buttons = optionsList.querySelectorAll(".option-button");
            buttons.forEach((btn, idx) => {
                btn.disabled = true;
                if (idx === q.correctIndex) {
                    btn.classList.add("correct");
                } else if (idx === selectedIndex && selectedIndex !== q.correctIndex) {
                    btn.classList.add("wrong");
                }
            });

            if (selectedIndex === q.correctIndex) {
                feedback.textContent = "Spr√°vnƒõ! üëç";
                feedback.className = "ok";
            } else {
                feedback.textContent = "≈†patnƒõ. Spr√°vn√° odpovƒõƒè je zv√Ωraznƒõna zelenƒõ.";
                feedback.className = "bad";
            }
            nextBtn.disabled = false;
        } else {
            userAnswers[currentIndex] = selectedIndex;
            currentIndex++;
            if (currentIndex < currentQuestions.length) {
                showQuestion();
            } else {
                finishTest();
            }
        }
    }

    nextBtn.addEventListener("click", () => {
        currentIndex++;
        showQuestion();
    });

    finishBtn.addEventListener("click", () => {
        finishTest();
    });

    // ---------- VYHODNOCEN√ç ----------
    function finishTest() {
        stopTimer();
        let total = currentQuestions.length;
        correctCount = 0;

        for (let i = 0; i < total; i++) {
            if (userAnswers[i] === currentQuestions[i].correctIndex) {
                correctCount++;
            }
        }

        const percent = Math.round((correctCount / total) * 100);
        scoreDiv.textContent = `V√Ωsledek: ${correctCount} z ${total} bod≈Ø (${percent} %).`;

        let html = "<h3>P≈ôehled odpovƒõd√≠</h3>";
        html += "<table><tr><th>#</th><th>Ot√°zka</th><th>Tvoje odpovƒõƒè</th><th>Spr√°vn√° odpovƒõƒè</th></tr>";

        currentQuestions.forEach((q, index) => {
            const userIndex = userAnswers[index];
            const userText = userIndex != null ? q.options[userIndex] : "neodpovƒõzeno";
            const correctText = q.options[q.correctIndex];

            html += `<tr>
                        <td>${index + 1}</td>
                        <td>${q.text}</td>
                        <td>${userText}</td>
                        <td>${correctText}</td>
                    </tr>`;
        });

        html += "</table>";
        summaryDiv.innerHTML = html;
    }

    // ---------- ƒåASOVAƒå ----------
    function startTimer() {
        timeLeft = TEST_TIME_LIMIT;
        updateTimerDisplay();
        timerId = setInterval(() => {
            timeLeft--;
            if (timeLeft <= 0) {
                timeLeft = 0;
                updateTimerDisplay();
                finishTest();
            } else {
                updateTimerDisplay();
            }
        }, 1000);
    }

    function stopTimer() {
        if (timerId !== null) {
            clearInterval(timerId);
            timerId = null;
        }
    }

    function updateTimerDisplay() {
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timerDiv.textContent = timeLeft > 0
            ? `Zb√Ωvaj√≠c√≠ ƒças: ${minutes}:${seconds.toString().padStart(2, "0")}`
            : "";
    }

    // ---------- POMOCN√â FUNKCE ----------
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }

    function prepareQuestions(allQuestions) {
        const prepared = allQuestions.map(original => {
            const indices = original.options.map((_, idx) => idx);
            shuffleArray(indices);

            const newOptions = indices.map(i => original.options[i]);
            const newCorrectIndex = indices.indexOf(original.correctIndex);

            return {
                text: original.text,
                options: newOptions,
                correctIndex: newCorrectIndex
            };
        });

        shuffleArray(prepared);
        return prepared;
    }
</script>
</body>
</html>



